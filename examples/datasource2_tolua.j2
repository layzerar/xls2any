-- This file is generated by xls2any
{% set ws1 = loadws('./datasource2.xlsx', '等级倍率', 3) -%} -- 读取./datasource2.xlsx文件的等级倍率工作表作为ws1，并指定第3行为表头
{% do output('./datasource2.lua') -%} -- 将模板生成的结果保存到datasource2.lua文件
--等级倍率表
levelRateConfig =
{
{%- do ws1.chkuniq('B4:C') %} --检查分组唯一性
{%- for keys, rows in ws1['4:'] | xgroupby('@id') %}  --数据从第四行开始取
	{
	    id = {{ keys[0] }},		--倍率表id
		rateList  = {
			{%- for row in rows %}
			{level = {{ row['@level'] }}, rate = {{ row['@rate'] }}}, --等级,奖励倍率,非万份比
			{%- endfor %}
		},
	},
{%- endfor %}
}
